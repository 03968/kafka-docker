{"name":"Kafka Docker","tagline":"Run multiple Kafka brokers in Docker","body":"Following the excellent tutorials on how to run a multi broker kafka cluster natively:\r\n[http://www.michael-noll.com/blog/2013/03/13/running-a-multi-broker-apache-kafka-cluster-on-a-single-node/](http://www.michael-noll.com/blog/2013/03/13/running-a-multi-broker-apache-kafka-cluster-on-a-single-node/) and in vagrant: [http://allthingshadoop.com/2013/12/07/using-vagrant-to-get-up-and-running-with-apache-kafka/] (http://allthingshadoop.com/2013/12/07/using-vagrant-to-get-up-and-running-with-apache-kafka/)\r\n\r\nHere is the tutorial based on Docker:\r\n\r\n1. Install [Docker](https://www.docker.io/gettingstarted/#h_installation) \r\n\r\n```\r\n$ export START_SCRIPT=https://raw2.github.com/wurstmeister/kafka-docker/master/start-broker.sh\r\n$ curl -Ls $START_SCRIPT | bash /dev/stdin <id-1> <port-1> <host-ip>\r\n$ curl -Ls $START_SCRIPT | bash /dev/stdin <id-2> <port-2> <host-ip>\r\n$ ... \r\n```\r\n\r\ne.g. to start a cluster with two brokers on localhost\r\n\r\n```\r\n$ curl -Ls $START_SCRIPT | bash /dev/stdin 1 9092 localhost\r\n$ curl -Ls $START_SCRIPT | bash /dev/stdin 2 9093 localhost\r\n```\r\n\r\nThis will start a single zookeeper instance on localhost:49181, a kafka instance on localhost:9092 and one on localhost:9093.\r\n\r\nYou can interact with your kafka cluster via the kafka shell:\r\n\r\n```\r\n$ docker run -link zookeeper:zk -i -t wurstmeister/kafka /bin/bash\r\n```\r\n\r\nInside the shell you can use any kafka command, e.g:\r\n```\r\n$KAFKA_HOME/bin/kafka-topics.sh --list --zookeeper $ZK_PORT_2181_TCP_ADDR\r\n$KAFKA_HOME/bin/kafka-topics.sh --create --topic topic \\\r\n--partitions 2 --zookeeper $ZK_PORT_2181_TCP_ADDR --replication-factor 1\r\n```\r\n\r\n# Running docker withing vagrant:\r\n\r\nIf you are running docker within vagrant, make sure you enable port forwarding:\r\n```\r\n$ FORWARD_DOCKER_PORTS='true' vagrant up\r\n```\r\nand set the <host-ip> to the IP of you docker host (i.e. you vagrant vm ip)\r\n\r\n# Troubleshooting:\r\n\r\nBy default a kafka broker uses 1GB of memory, so if you have trouble starting a broker, check docker logs for the container and make sure you've got enough memory available on your host","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}